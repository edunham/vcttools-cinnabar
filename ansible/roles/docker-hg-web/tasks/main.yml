---
- name: install system packages
  command: yum install -y lockfile-progs openssh-clients openssh-server syslog

- name: install mirroring scripts
  copy: src={{ item }} dest=/usr/local/bin/{{ item }} mode=0755
  with_items:
    - lockfile
    - repo-group

- include: ../../../tasks/hgmo-extensions.yml

- name: install hgweb wsgi files
  copy: src={{ item }} dest=/repo/hg/webroot_wsgi/{{ item }} owner=hg group=hg
  with_items:
    - hgweb.config
    - hgweb.wsgi

- name: install Docker support files
  copy: src={{ item }} dest=/{{ item }} owner=root group=root mode=0755
  with_items:
    - entrypoint.py
    - run.sh
    - set-mirror-key.py
