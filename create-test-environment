#!/bin/sh

set -e

if [ ! -d venv ]; then
  virtualenv venv
fi

source venv/bin/activate
pip install --upgrade -r test-requirements.txt

# ReviewBoard doesn't work with pip, sadly.
easy_install ReviewBoard==2.0.2

# rbmozui requires Node.js when installed normally. But in local
# development mode it doesn't. So use local development node.
mkdir -p venv/tmp
if [ -d venv/tmp/rbmozui ]; then
  cd venv/tmp/rbmzui && git pull
else
  git clone git@github.com:mikeconley/rbmozui.git venv/tmp/rbmozui
fi

cd venv/tmp/rbmozui && python setup.py develop
